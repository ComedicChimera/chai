package basic_tests

@entry
def _start()
    main()
    ExitProcess(0)
end

@[extern, callconv("win64")]
def ExitProcess(code: u32) end

@[extern, callconv("win64")]
def GetStdHandle(nStdHandle: u32) *u8 end

@[extern, callconv("win64")]
def WriteConsoleA(
    hConsoleOutput, lpBuffer: *u8, 
    nNumberOfCharsToWrite: u32, 
    lpNumberOfCharsWritten: *u32, 
    lpReserved: *u8
) bool end

def get_stdout() *u8 = GetStdHandle(4_294_967_285)

def putc(handle: *u8, c: u32) 
    WriteConsoleA(handle, &(c as u8), 1, null, null)
end

def main()
    let h = get_stdout()

    putc(h, 'H')
    putc(h, 'e')
    putc(h, 'l')
    putc(h, 'l')
    putc(h, 'o')
    putc(h, '\n')
end